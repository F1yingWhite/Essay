![[Pasted image 20240808094527.png]]
总体生存曲线图如上所示
# 直接KMeans
我们直接对slide level embedding进行二分类然后绘制曲线得到的结果如下
![[Pasted image 20240808094517.png]]
## 个人疑问
PFS为什么大于OS?从定义角度出发,pds应该<=OS才对
## 预测PFS/OS
使用预训练模型giga-path计算出slide-level级别的Embedding,然后回归pfs,然后失败了
问题:模型不收敛
> 个人认为PFS不存在回归的意义,大部分病人的事件缺失了,或者部分的病人信息发生了丢失
> 病人的信息丢失率较高,204/142,只有204个人被最后回访了
## 计算risk分数
区分为high risk和low risk

计算risk的任务似乎有点小寄
问题1: loss为nan:
>根据cox损失函数的定义,如果模型的输入全部是删失数据,那么得到的结果将为nan

问题2:使用的能够1billion token的模型会发生显存溢出
![[Pasted image 20240808161207.png]]
如果输入全部都是删失数据,那么loss将得到NaN.也就是不存在

## 二分类(进展)
我们把进展的和没有进展的分别设置为0类和1类,然后使用简单的交叉熵损失函数来计算(<font color="#ff0000">错误的思路,应该使用最后随访状态</font>)
![[Pasted image 20240809151028.png]]Log-rank test p-value: 1.9026211115366723e-34
直接使用两个分类层的方法看起来也失败了,使用原来的dsmil的方法重新进行系统的训练试试

新的方法:
应该使用最后随访状态作为有没有进展,可以使用1表示存活,0表示死亡,或者相反,但是注意如果是前一种表达形式,需要切换为1为事件发生(即死亡)
## 二分类(最后随访状态)
![[Pasted image 20240811103306.png]]
如果是用最后随访状态+OS的话能够得到如上图片
但是如果使用最后随访状态+PFS只能得到以下的图片,P值为0.16,不具有统计学意义
![[Pasted image 20240811104343.png]]

